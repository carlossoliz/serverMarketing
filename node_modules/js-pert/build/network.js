"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.START = '__start';
exports.END = '__end';
const isStartingActivity = (activity) => activity.predecessors.length === 0;
const isFinalActivity = (activity, activities) => Object.values(activities).reduce((prev, currentActivity) => {
    if (currentActivity.predecessors.indexOf(activity.id) !== -1) {
        return false;
    }
    return prev;
}, true);
const initNetworkNode = (ref) => {
    if (ref) {
        return ref;
    }
    return { predecessors: [], successors: [] };
};
const getNetworkDiagram = (activities) => Object.values(activities).reduce((prev, activity) => {
    prev[activity.id] = initNetworkNode(prev[activity.id]);
    activity.predecessors.forEach(predecessor => {
        prev[predecessor] = initNetworkNode(prev[predecessor]);
        prev[predecessor].successors.push(activity.id);
    });
    prev[activity.id].predecessors = [...activity.predecessors];
    if (isStartingActivity(activity)) {
        prev[exports.START].successors.push(activity.id);
        prev[activity.id].predecessors.push(exports.START);
    }
    if (isFinalActivity(activity, activities)) {
        prev[exports.END].predecessors.push(activity.id);
        prev[activity.id].successors.push(exports.END);
    }
    return prev;
}, { [exports.START]: initNetworkNode(), [exports.END]: initNetworkNode() });
exports.default = getNetworkDiagram;
//# sourceMappingURL=network.js.map